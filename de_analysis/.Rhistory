for (dir in c('up', 'down')) {
assign(paste('intersect', samp, dir, sep=''), data.frame(get(paste('intersect', samp, dir, sep=''))))
assign(get(paste('intersect', samp, dir, sep='')), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
#assign(get(paste('intersect', samp, dir, sep=''))[,1], gsub("\\..*","", get(paste('intersect', samp, dir, sep=''))[,1]))
}
}
get(paste('intersect', samp, dir, sep=''))
cbind(get(paste('intersect', samp, dir, sep='')), ens=NA
)
get(paste('intersect', samp, dir, sep=''))
assign(get(paste('intersect', samp, dir, sep='')), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
type(get(paste('intersect', samp, dir, sep='')))
get(paste('intersect', samp, dir, sep=''))
type(get(paste('intersect', samp, dir, sep='')))
type((paste('intersect', samp, dir, sep='')))
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
assign(paste('intersect', samp, dir, sep=''), data.frame(get(paste('intersect', samp, dir, sep=''))))
assign(cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
#type((paste('intersect', samp, dir, sep='')))
#assign(get(paste('intersect', samp, dir, sep=''))[,1], gsub("\\..*","", get(paste('intersect', samp, dir, sep=''))[,1]))
}
}
cbind
cbind
?cbind
get(paste('intersect', samp, dir, sep=''))
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
assign(paste('intersect', samp, dir, sep=''), data.frame(get(paste('intersect', samp, dir, sep=''))))
#assign(get(paste('intersect', samp, dir, sep='')), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
#assign(get(paste('intersect', samp, dir, sep=''))[,1], gsub("\\..*","", get(paste('intersect', samp, dir, sep=''))[,1]))
}
}
get(paste('intersect', samp, dir, sep=''))
get(paste('intersect', samp, dir, sep=''))
cbind(get(paste('intersect', samp, dir, sep='')), ens=NA)
assign(get(paste('intersect', samp, dir, sep='')), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
View(intersect_all_down)
View(intersect_all_up)
View(intersect1_wt_down)
View(intersect1_wt_up)
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
assign(paste('intersect', samp, dir, sep=''), data.frame(get(paste('intersect', samp, dir, sep=''))))
assign((paste('intersect', samp, dir, sep=''), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
assign(paste('intersect', samp, dir, sep=''), data.frame(get(paste('intersect', samp, dir, sep=''))))
assign(paste('intersect', samp, dir, sep=''), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
#assign(get(paste('intersect', samp, dir, sep=''))[,1], gsub("\\..*","", get(paste('intersect', samp, dir, sep=''))[,1]))
}
}
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
assign(paste('intersect', samp, dir, sep=''), data.frame(get(paste('intersect', samp, dir, sep=''))))
assign(paste('intersect', samp, dir, sep=''), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
assign(get(paste('intersect', samp, dir, sep=''))[,2], gsub("\\..*","", get(paste('intersect', samp, dir, sep=''))[,1]))
}
}
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
assign(paste('intersect', samp, dir, sep=''), data.frame(get(paste('intersect', samp, dir, sep=''))))
assign(paste('intersect', samp, dir, sep=''), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
assign(get(paste('intersect', samp, dir, sep=''))[,2], gsub("\\..*','", get(paste('intersect', samp, dir, sep=''))[,1]))
}
}
get(paste('intersect', samp, dir, sep=''))[,1]
paste('intersect', samp, dir, sep=''))
paste('intersect', samp, dir, sep='')
get(paste('intersect', samp, dir, sep=''))
get(paste('intersect', samp, dir, sep=''))[,1]
gsub("\\..*", "", get(paste('intersect', samp, dir, sep=''))[,1])
paste('intersect', samp, dir, sep='')
get(paste('intersect', samp, dir, sep=''))
get(paste('intersect', samp, dir, sep=''))[,2]
get(paste('intersect', samp, dir, sep=''))$ens
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
assign(paste('intersect', samp, dir, sep=''), data.frame(get(paste('intersect', samp, dir, sep=''))))
assign(paste('intersect', samp, dir, sep=''), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
assign(get(paste('intersect', samp, dir, sep=''))$ens, gsub("\\..*", "", get(paste('intersect', samp, dir, sep=''))[,1]))
}
}
?gsub
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
assign(paste('intersect', samp, dir, sep=''), data.frame(get(paste('intersect', samp, dir, sep=''))))
assign(paste('intersect', samp, dir, sep=''), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
assign(get(paste('intersect', samp, dir, sep=''))$ens, gsub('\\..*', "", get(paste('intersect', samp, dir, sep=''))[,1]))
}
}
gsub('\\..*', "", get(paste('intersect', samp, dir, sep=''))[,1])
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
assign(paste('intersect', samp, dir, sep=''), data.frame(get(paste('intersect', samp, dir, sep=''))))
assign(paste('intersect', samp, dir, sep=''), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
assign(get(paste('intersect', samp, dir, sep=''))$ens, gsub('\\..*', '', get(paste('intersect', samp, dir, sep=''))[,1]))
}
}
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
assign(paste('intersect', samp, dir, sep=''), data.frame(get(paste('intersect', samp, dir, sep=''))))
assign(paste('intersect', samp, dir, sep=''), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
assign(get(paste('intersect', samp, dir, sep=''))['ens'], gsub('\\..*', '', get(paste('intersect', samp, dir, sep=''))[,1]))
}
}
get(paste('intersect', samp, dir, sep=''))[,2]
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
assign(paste('intersect', samp, dir, sep=''), data.frame(get(paste('intersect', samp, dir, sep=''))))
assign(paste('intersect', samp, dir, sep=''), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
assign(get(paste('intersect', samp, dir, sep=''))[,2], gsub('\\..*', '', get(paste('intersect', samp, dir, sep=''))[,1]))
}
}
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
assign(intersect <- data.frame(paste('intersect', samp, dir, sep='')))
#assign(paste('intersect', samp, dir, sep=''), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
#assign(get(paste('intersect', samp, dir, sep=''))[,2], gsub('\\..*', '', get(paste('intersect', samp, dir, sep=''))[,1]))
}
}
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
intersect <- data.frame(paste('intersect', samp, dir, sep='')))
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
intersect <- data.frame(paste('intersect', samp, dir, sep=''))
#assign(paste('intersect', samp, dir, sep=''), cbind(get(paste('intersect', samp, dir, sep='')), ens=NA))
#assign(get(paste('intersect', samp, dir, sep=''))[,2], gsub('\\..*', '', get(paste('intersect', samp, dir, sep=''))[,1]))
}
}
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
intersect <- data.frame(paste('intersect', samp, dir, sep=''))
intersect$ens <- gsub('\\..*', '', intersect[,1])
}
}
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
intersect <- data.frame(paste('intersect', samp, dir, sep=''))
intersect$ens <<- gsub('\\..*', '', intersect[,1])
}
}
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
intersect <<- data.frame(paste('intersect', samp, dir, sep=''))
intersect$ens <<- gsub('\\..*', '', intersect[,1])
}
}
View(intersect)
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
intersect <<- data.frame(paste('intersect', samp, dir, sep=''))
intersect['ens'] <<- gsub('\\..*', '', intersect[,1])
}
}
intersect <- data.frame(paste('intersect', samp, dir, sep=''))
intrsect <- data.frame(paste('intersect', samp, dir, sep=''))
intrsect['ens'] <- gsub('\\..*', '', intrsect[,1])
View(intrsect)
intrsect <- data.frame(get(paste('intersect', samp, dir, sep='')))
intrsect['ens'] <- gsub('\\..*', '', intrsect[,1])
View(intrsect)
intrsect <- data.frame(get(paste('intersect', samp, dir, sep='')))
intrsect$ens <- gsub('\\..*', '', intrsect[,1])
View(intrsect)
intrsect$symbol <- mapIds(org.Hs.eg.db, keys = intrsect, keytype = 'ENSEMBL', column = 'SYMBOL')
intrsect <- data.frame(get(paste('intersect', samp, dir, sep='')))
intrsect$ens <- gsub('\\..*', '', intrsect[,1])
intrsect$symbol <- mapIds(org.Hs.eg.db, keys = intrsect[,2], keytype = 'ENSEMBL', column = 'SYMBOL')
View(intrsect)
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
intrsect <- data.frame(get(paste('intersect', samp, dir, sep='')))
intrsect$ens <- gsub('\\..*', '', intrsect[,1])
intrsect$symbol <- mapIds(org.Hs.eg.db, keys = intrsect[,2], keytype = 'ENSEMBL', column = 'SYMBOL')
assign(get(paste('intersect', samp, dir, sep='')), intrsect)
}
}
View(ENSG00000002079.14)
View(ENSG00000003147.19)
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
samp <- '1_wt_'
for (samp in c('1_wt_', '2_opt_', '3_gfp_', '4_ctrl_', '_all_') ) {
for (dir in c('up', 'down')) {
intrsect <- data.frame(get(paste('intersect', samp, dir, sep='')))
intrsect$ens <- gsub('\\..*', '', intrsect[,1])
intrsect$symbol <- mapIds(org.Hs.eg.db, keys = intrsect[,2], keytype = 'ENSEMBL', column = 'SYMBOL')
assign(paste('intersect', samp, dir, sep=''), intrsect)
}
}
View(intersect4_ctrl_up)
View(sigs_opt_ctrl)
res_df <<- data.frame(shrunken)
unshrunken <- results(dds, contrast = get(paste('contrast_', samp, sep='')))
samp <- 'opt_ctrl'
unshrunken <- results(dds, contrast = get(paste('contrast_', samp, sep='')))
shrunken <- lfcShrink(dds, contrast = get(paste('contrast_', samp, sep='')),
res=unshrunken, type='normal')
res_df <<- data.frame(shrunken)
res_df$ens <- gsub("\\..*","", rownames(res_df))
res_df$symbol <- mapIds(org.Hs.eg.db, keys = res_df$ens, keytype = 'ENSEMBL', column = 'SYMBOL')
res_df[rownames(res_df[is.na(res_df$symbol), ]), 'symbol'] <<- rownames(res_df[is.na(res_df$symbol),])
res_df[rownames(res_df[is.na(res_df$symbol), ]), 'symbol'] <- rownames(res_df[is.na(res_df$symbol),])
View(res_df)
sigs <<- filter(res_df, padj < pval & abs(log2FoldChange) > lfc)
View(sigs)
shrink <- function(samp, pval, lfc) {
unshrunken <- results(dds, contrast = get(paste('contrast_', samp, sep='')))
shrunken <- lfcShrink(dds, contrast = get(paste('contrast_', samp, sep='')),
res=unshrunken, type='normal')
res_df <<- data.frame(shrunken)
res_df$ens <- gsub("\\..*","", rownames(res_df))
res_df$symbol <- mapIds(org.Hs.eg.db, keys = res_df$ens, keytype = 'ENSEMBL', column = 'SYMBOL')
res_df[rownames(res_df[is.na(res_df$symbol), ]), 'symbol'] <- rownames(res_df[is.na(res_df$symbol),])
sigs <<- filter(res_df, padj < pval & abs(log2FoldChange) > lfc)
}
for (samp in c('wt_ctrl','opt_ctrl', 'opt_wt', 'wt_gfp', 'opt_gfp')) {
shrink(samp, pval, lfc)
assign(paste('sigs_', samp, sep=''), sigs[,c('symbol', 'baseMean', 'log2FoldChange', 'lfcSE', 'stat', 'pvalue', 'padj')])
#  write.table(get(paste('sigs_', samp, sep=''))[c('symbol', 'padj', 'log2FoldChange')],
#              file=paste('results/sigs_', samp, '_l2fc=', lfc, '_padj=', pval, '.txt', sep=''), sep="\t", quote=F, col.names=NA)
assign(paste('sigs_down_', samp, sep=''), filter(get(paste('sigs_', samp, sep='')), padj < pval & log2FoldChange < lfc))
#  write.table(get(paste('sigs_down_', samp, sep=''))[c('symbol', 'padj', 'log2FoldChange')],
#              file=paste('results/sigs_', samp, '_down_l2fc=', lfc, '_padj=', pval, '.txt', sep=''), sep="\t", quote=F, col.names=NA)
assign(paste('sigs_up_', samp, sep=''), filter(get(paste('sigs_', samp, sep='')), padj < pval & log2FoldChange > lfc))
#  write.table(get(paste('sigs_up_', samp, sep=''))[c('symbol', 'padj', 'log2FoldChange')],
#              file=paste('results/sigs_', samp, '_up_l2fc=', lfc, '_padj=', pval, '.txt', sep=''), sep="\t", quote=F, col.names=NA)
nrow(get(paste('sigs_', samp, sep=''))) == nrow(get(paste('sigs_up_', samp, sep='')))+nrow(get(paste('sigs_down_', samp, sep='')))
#volcano(samp, pval, lfc)
#heat(samp, pval, lfc)
#go_bar(samp, pval, lfc)
} ### never delete middle strings!
i <- 1
for (samp in list(c('wt_ctrl', 'wt_gfp'), c('opt_ctrl', 'opt_gfp'), c('wt_gfp', 'opt_gfp'), c('wt_ctrl', 'opt_ctrl')) ) {
#print(samp[2])
for (dir in c('up', 'down')) {
venn.diagram(
x = list(row.names(get(paste('sigs_', dir, '_', samp[1], sep=''))), row.names(get(paste('sigs_', dir, '_', samp[2], sep='')))),
category.names = c(samp[1], samp[2]),
filename = paste('plots/venn_', as.character(i), '_', dir, '.png', sep=''),
output=TRUE,
fill = c(2,4),
main = paste('Venn diagram of ', samp[1], ' and ', samp[2], ', ', dir, '-regulated', sep='')
)
}
i <- i + 1
}
### mega-venn
for (dir in c('up', 'down')) {
venn.diagram(
x = list(row.names(get(paste('sigs_', dir, '_wt_ctrl', sep=''))), row.names(get(paste('sigs_', dir, '_wt_gfp', sep=''))), row.names(get(paste('sigs_', dir, '_opt_ctrl', sep=''))), row.names(get(paste('sigs_', dir, '_opt_gfp', sep='')))),
category.names = c("wt_ctrl", "wt_gfp", 'opt_ctrl', 'opt_gfp'),
filename = paste('plots/venn_', dir, '.png', sep=''),
output=TRUE,
fill = c(1,2,3,4),
main = paste('Venn diagram, ', dir, '-regulated', sep='')
)
}
intersect1_wt_down <- intersect(rownames(sigs_down_wt_gfp), rownames(sigs_down_wt_ctrl))
intersect1_wt_up <- intersect(rownames(sigs_up_wt_gfp), rownames(sigs_up_wt_ctrl))
intersect2_opt_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_opt_ctrl))
intersect2_opt_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_opt_ctrl))
intersect3_gfp_down <- intersect(rownames(sigs_down_opt_gfp), rownames(sigs_down_wt_gfp))
intersect3_gfp_up <- intersect(rownames(sigs_up_opt_gfp), rownames(sigs_up_wt_gfp))
intersect4_ctrl_down <- intersect(rownames(sigs_down_opt_ctrl), rownames(sigs_down_wt_ctrl))
intersect4_ctrl_up <- intersect(rownames(sigs_up_opt_ctrl), rownames(sigs_up_wt_ctrl))
intersect_all_down <- intersect((intersect3_gfp_down), (intersect4_ctrl_down))
intersect_all_up <- intersect((intersect3_gfp_up), (intersect4_ctrl_up))
View(sigs_down_opt_ctrl)
View(sigs_down_opt_gfp)
View(sigs_down_opt_wt)
View(sigs_down_wt_ctrl)
intersect1_wt_down <- intersect(sigs_down_wt_gfp$symbol, sigs_down_wt_ctrl$symbol)
intersect1_wt_up <- intersect(sigs_up_wt_gfp$symbol, sigs_up_wt_ctrl$symbol)
intersect2_opt_down <- intersect(sigs_down_opt_gfp$symbol, sigs_down_opt_ctrl$symbol)
intersect2_opt_up <- intersect(sigs_up_opt_gfp$symbol, sigs_up_opt_ctrl$symbol)
intersect3_gfp_down <- intersect(sigs_down_opt_gfp$symbol, sigs_down_wt_gfp$symbol)
intersect3_gfp_up <- intersect(sigs_up_opt_gfp$symbol, sigs_up_wt_gfp$symbol)
intersect4_ctrl_down <- intersect(sigs_down_opt_ctrl$symbol, sigs_down_wt_ctrl$symbol)
intersect4_ctrl_up <- intersect(sigs_up_opt_ctrl$symbol, sigs_up_wt_ctrl$symbol)
intersect_all_down <- intersect(intersect_gfp_down, intersect_ctrl_down)
intersect_all_down <- intersect(intersect3_gfp_down, intersect4_ctrl_down)
intersect_all_up <- intersect(intersect3_gfp_up, intersect4_ctrl_up)
intersect_all_down
intersect_all_up
intersect1_wt_down <- intersect(sigs_down_wt_gfp$symbol, sigs_down_wt_ctrl$symbol)
intersect1_wt_up <- intersect(sigs_up_wt_gfp$symbol, sigs_up_wt_ctrl$symbol)
intersect2_opt_down <- intersect(sigs_down_opt_gfp$symbol, sigs_down_opt_ctrl$symbol)
intersect2_opt_up <- intersect(sigs_up_opt_gfp$symbol, sigs_up_opt_ctrl$symbol)
intersect3_gfp_down <- intersect(sigs_down_opt_gfp$symbol, sigs_down_wt_gfp$symbol)
intersect3_gfp_up <- intersect(sigs_up_opt_gfp$symbol, sigs_up_wt_gfp$symbol)
intersect4_ctrl_down <- intersect(sigs_down_opt_ctrl$symbol, sigs_down_wt_ctrl$symbol)
intersect4_ctrl_up <- intersect(sigs_up_opt_ctrl$symbol, sigs_up_wt_ctrl$symbol)
intersect_all_down <- intersect(intersect3_gfp_down, intersect4_ctrl_down)
intersect_all_up <- intersect(intersect3_gfp_up, intersect4_ctrl_up)
intersect1_wt_down
intersect1_wt_up
intersect2_opt_down
intersect2_opt_up
intersect3_gfp_down
intersect3_gfp_up
intersect4_ctrl_down
intersect4_ctrl_up
